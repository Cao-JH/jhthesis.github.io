import{z as x,g as H,a as h,r as V,c as r,d as f,e as g,f as u,h as t,w as a,A as P,F as C,k as I,B as G,s as N,t as Q,j as _,v as b,C as W}from"./index-29034bfe.js";function X(d){return x({url:"/api/inspextor/",method:"post",data:d})}function Y(d){return x({url:"/api/inspextor/add",method:"post",data:d})}function Z(d){return x({url:"/api/inspextor/update",method:"post",data:d})}function ee(d){return x({url:"/api/inspextor/del",method:"post",data:d})}const le={class:"top-panel"},te={key:0},ae={key:1},oe={class:"op"},ne=["onClick"],se=["onClick"],ue={__name:"List",setup(d){const{proxy:w}=H(),T=[{label:"ID",prop:"id",width:50},{label:"巡查人员姓名",prop:"name",width:150},{label:"账号",prop:"account",width:150},{label:"电话",prop:"phone",width:150},{label:"年龄",prop:"age",width:80,scopedSlots:"age"},{label:"性别",prop:"gender",width:60,scopedSlots:"gender"},{label:"邮箱",prop:"email",width:240},{label:"入职时间",prop:"created_at",width:240},{label:"操作",prop:"op",scopedSlots:"op"}],o=h({}),y=h(),D=(s,e)=>{i.show=!0,W(()=>{y.value.resetFields(),s=="add"?(i.title="新增人员",o.value={type:"add"}):s=="update"&&(i.title="编辑巡查人员信息",o.value=JSON.parse(JSON.stringify(e)),Object.assign(o.value,{type:"update"}))})},i=V({show:!1,title:"标题",buttons:[{type:"danger",text:"确定",click:s=>{B()}}]}),B=()=>{y.value.validate(async s=>{if(!s)return;let{type:e}=o.value,v={};Object.assign(v,o.value);let n="";e=="add"?n=await Y(v):n=await Z(v),n.code==200?(i.show=!1,w.message.success(n.msg),m()):w.message.error(n.msg)})},F=h({name:{required:!0,message:"请输入巡查人员姓名"},account:{required:!0,message:"请输入账号"},phone:{required:!0,message:"请输入电话"},age:{required:!0,message:"请输入年龄"},gender:{required:!0,message:"请选择性别",trigger:"blur"}}),S=V({list:[]}),L={extHeight:50},c=h({}),U=[{value:"",label:"全部"},{value:"male",label:"男"},{value:"female",label:"女"}],j=V({page:1,pageSize:10,pageCount:0,count:0,keyword:"",gender:""}),m=async()=>{Object.assign(j,c.value);let s=await X(j);s.code==200&&Object.assign(S,s.data)},A=s=>{w.confirm(`你确定要删除${s.name}吗?`,async()=>{let e=await ee({id:s.id});if(e.code==200)w.message.success(e.msg),m();else return})};return(s,e)=>{const v=r("el-button"),n=r("el-form-item"),k=r("el-col"),K=r("el-input"),O=r("el-option"),$=r("el-select"),z=r("el-row"),q=r("el-form"),J=r("el-divider"),M=r("Table"),R=r("Dialog");return f(),g(C,null,[u("div",le,[t(q,{onSubmit:e[5]||(e[5]=P(()=>{},["prevent"])),model:c.value,class:"search-form",labelAlign:"left"},{default:a(()=>[t(z,{gutter:5},{default:a(()=>[t(k,{span:2},{default:a(()=>[t(n,null,{default:a(()=>[t(v,{type:"primary",onClick:e[0]||(e[0]=l=>D("add"))},{default:a(()=>[I("添加")]),_:1})]),_:1})]),_:1}),t(k,{span:5},{default:a(()=>[t(n,{label:""},{default:a(()=>[t(K,{modelValue:c.value.keyword,"onUpdate:modelValue":e[1]||(e[1]=l=>c.value.keyword=l),placeholder:"支持模糊搜索",onKeyup:G(m,["enter","native"]),allowClear:""},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),t(k,{span:2},{default:a(()=>[t(n,null,{default:a(()=>[t(v,{type:"danger",onClick:e[2]||(e[2]=l=>m())},{default:a(()=>[I("搜索")]),_:1})]),_:1})]),_:1}),t($,{span:2,modelValue:c.value.gender,"onUpdate:modelValue":e[4]||(e[4]=l=>c.value.gender=l),class:"m-2",placeholder:"性别"},{default:a(()=>[(f(),g(C,null,N(U,l=>t(O,{key:l.value,label:l.label,onClick:e[3]||(e[3]=p=>m()),value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),t(M,{columns:T,showPagination:!0,dataSource:S,fetch:m,options:L},{age:a(({index:l,row:p})=>[u("div",null,Q(p.age)+"岁",1)]),gender:a(({index:l,row:p})=>[p.gender=="male"?(f(),g("div",te,"男")):(f(),g("div",ae,"女"))]),op:a(({index:l,row:p})=>[u("div",oe,[u("a",{href:"javascript:void(0)",class:"a-link",onClick:E=>D("update",p)},"修改",8,ne),t(J,{direction:"vertical"}),u("a",{href:"javascript:void(0)",class:"a-link",onClick:E=>A(p)},"删除",8,se)])]),_:1},8,["dataSource"]),t(R,{title:i.title,show:i.show,buttons:i.buttons,onClose:e[12]||(e[12]=l=>i.show=!1),width:"600px"},{default:a(()=>[t(q,{model:o.value,rules:F.value,ref_key:"formDataRef",ref:y,"label-width":"80px"},{default:a(()=>[t(n,{prop:"name",label:"姓名"},{default:a(()=>[_(u("input",{placeholder:"请输入姓名","onUpdate:modelValue":e[6]||(e[6]=l=>o.value.name=l)},null,512),[[b,o.value.name]])]),_:1}),t(n,{prop:"account",label:"账号"},{default:a(()=>[_(u("input",{placeholder:"请输入账号","onUpdate:modelValue":e[7]||(e[7]=l=>o.value.account=l)},null,512),[[b,o.value.account]])]),_:1}),t(n,{prop:"phone",label:"电话"},{default:a(()=>[_(u("input",{placeholder:"请输入电话","onUpdate:modelValue":e[8]||(e[8]=l=>o.value.phone=l)},null,512),[[b,o.value.phone]])]),_:1}),t(n,{prop:"email",label:"邮箱"},{default:a(()=>[_(u("input",{placeholder:"请输入邮箱","onUpdate:modelValue":e[9]||(e[9]=l=>o.value.email=l)},null,512),[[b,o.value.email]])]),_:1}),t(n,{prop:"age",label:"年龄"},{default:a(()=>[_(u("input",{placeholder:"请输入年龄","onUpdate:modelValue":e[10]||(e[10]=l=>o.value.age=l)},null,512),[[b,o.value.age]])]),_:1}),t(n,{prop:"gender",label:"性别"},{default:a(()=>[t($,{modelValue:o.value.gender,"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.gender=l),class:"m-2",placeholder:"性别"},{default:a(()=>[(f(),g(C,null,N(U,l=>t(O,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","show","buttons"])],64)}}};export{ue as default};
