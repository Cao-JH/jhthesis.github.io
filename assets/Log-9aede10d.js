import{g as A,a as w,r as y,c as s,d as n,e as c,f as u,h as l,w as t,A as E,F as _,s as V,D as M,k as z,t as H,x as S,p as P,l as q}from"./index-29034bfe.js";import{g as G,b as J}from"./record-424f0cbb.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";const Q=m=>(P("data-v-7ca17f40"),m=m(),q(),m),W={class:"top-panel"},X={key:0,style:{color:"#e74c3c"}},Y={key:1,style:{color:"#2ecc71"}},Z={class:"op"},ee=["onClick"],oe=["onClick"],le={class:"msg"},te=Q(()=>u("span",{class:"title"},"问题描述: ",-1)),ae={class:"body"},se={class:"dialog-footer"},ne={__name:"Log",setup(m){const{proxy:v}=A(),f=w([]),g=w([]),I=[{label:"ID",prop:"id",width:50},{label:"路线",prop:"rname",width:150},{label:"巡查人",prop:"uname",width:100},{label:"状态",prop:"status",width:100,scopedSlots:"status"},{label:"备注",prop:"notes"},{label:"完成时间",prop:"time",width:170},{label:"操作",prop:"op",width:150,scopedSlots:"op"}],d=w({}),C=y({list:[]}),L={extHeight:50},$=[{value:"",label:"全部"},{value:"1",label:"已完成巡查"},{value:"2",label:"存在问题"}],x=y({page:1,pageSize:10,pageCount:0,count:0,keyword:"",gender:""}),p=async()=>{Object.assign(x,d.value);let a=await G(x);a.code==200&&(Object.assign(C,a.data),f.value=a.data.inspector,g.value=a.data.routes,f.value.unshift({uname:"",name:"全部"}),g.value.unshift({rname:"",name:"全部"}))},B=a=>{v.confirm("你确定要删除该记录吗?",async()=>{const e=await J({id:a.id});e.code==200?(v.message.success(e.msg),p()):v.message.error(e.msg)})},i=y({open:!1}),D=a=>{i.open=!0,i.msg=a.notes};return(a,e)=>{const b=s("el-option"),k=s("el-select"),h=s("el-col"),j=s("el-row"),N=s("el-form"),U=s("el-divider"),F=s("Table"),O=s("el-button"),R=s("el-dialog");return n(),c(_,null,[u("div",W,[l(N,{onSubmit:e[6]||(e[6]=E(()=>{},["prevent"])),model:d.value,class:"search-form",labelAlign:"left"},{default:t(()=>[l(j,{gutter:5},{default:t(()=>[l(h,{span:4},{default:t(()=>[l(k,{modelValue:d.value.uname,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value.uname=o),class:"m-2",placeholder:"巡查人员"},{default:t(()=>[(n(!0),c(_,null,V(f.value,o=>(n(),S(b,{key:o.id,label:o.name,onClick:e[0]||(e[0]=r=>p()),value:o.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(h,{span:4},{default:t(()=>[l(k,{modelValue:d.value.rname,"onUpdate:modelValue":e[3]||(e[3]=o=>d.value.rname=o),class:"m-2",placeholder:"巡查路线"},{default:t(()=>[(n(!0),c(_,null,V(g.value,o=>(n(),S(b,{key:o.id,label:o.name,onClick:e[2]||(e[2]=r=>p()),value:o.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(h,{span:4},{default:t(()=>[l(k,{modelValue:d.value.sta,"onUpdate:modelValue":e[5]||(e[5]=o=>d.value.sta=o),class:"m-2",placeholder:"状态"},{default:t(()=>[(n(),c(_,null,V($,o=>l(b,{key:o.value,label:o.label,onClick:e[4]||(e[4]=r=>p()),value:o.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model"])]),l(F,{columns:I,showPagination:!0,dataSource:C,fetch:p,options:L},{status:t(({index:o,row:r})=>[r.status==2?(n(),c("div",X,"存在问题")):(n(),c("div",Y,"完成巡查"))]),op:t(({index:o,row:r})=>[u("div",Z,[u("a",{href:"javascript:void(0)",class:"a-link",onClick:T=>B(r)},"删除",8,ee),l(U,{direction:"vertical"}),r.status==2?(n(),c("a",{key:0,href:"javascript:void(0)",class:"a-link",onClick:T=>D(r)},"查看问题",8,oe)):M("",!0)])]),_:1},8,["dataSource"]),l(R,{modelValue:i.open,"onUpdate:modelValue":e[8]||(e[8]=o=>i.open=o),title:"问题详情",class:"photoBox",width:"30%",center:""},{footer:t(()=>[u("span",se,[l(O,{onClick:e[7]||(e[7]=o=>i.open=!1)},{default:t(()=>[z("关闭")]),_:1})])]),default:t(()=>[u("div",le,[te,u("span",ae,H(i.msg),1)])]),_:1},8,["modelValue"])],64)}}},ue=K(ne,[["__scopeId","data-v-7ca17f40"]]);export{ue as default};
