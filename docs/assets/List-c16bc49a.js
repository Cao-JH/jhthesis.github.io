import{E as T,G as E,g as F,u as K,r as f,a as b,c as s,d as M,e as q,f as p,h as t,w as o,A,F as P,k,B as z}from"./index-e734480e.js";import{r as G,d as H}from"./route-506fe335.js";import{d as J}from"./equipment-d5176f02.js";const U={class:"top-panel"},Q={class:"op"},W=["onClick"],X=["onClick"],oe={__name:"List",setup(Y){const d=T();E(d);const{proxy:u}=F(),y=K(),C=[{label:"ID",prop:"id",width:50},{label:"路线名称",prop:"name",width:150},{label:"路线内容",prop:"description"},{label:"创建时间",prop:"created_at",width:250},{label:"操作",prop:"op",width:180,scopedSlots:"op"}],a=f({show:!1,title:"查看路线",buttons:[{type:"danger",text:"关闭",click:()=>{a.show=!1}}]}),x=()=>{y.push("map")},r=b({}),g=f({list:[]}),S={extHeight:50},w=f({page:1,pageSize:10,pageCount:0,count:0,keyword:"",gender:""}),c=async()=>{Object.assign(w,r.value);let n=await G(w);n.code==200&&(Object.assign(g,n.data),console.log(n.data))},V=n=>{u.confirm("确定要删除该路线吗?",async()=>{const e=await H(n);if(e.code==200)u.message.success(e.msg),c();else return})},v=b(),$=async n=>{v.value=n;const e=JSON.parse(`[${v.value.points}]`);d.list=e;const l=await J({lnglat:e});l.code==200?(d.list=l.list,a.title=n.name,a.show=!0):u.message.error("加载失败，请重试!")};return(n,e)=>{const l=s("el-button"),m=s("el-form-item"),_=s("el-col"),D=s("el-input"),j=s("el-row"),B=s("el-form"),I=s("el-divider"),L=s("Table"),N=s("Map"),O=s("Dialog");return M(),q(P,null,[p("div",U,[t(B,{onSubmit:e[3]||(e[3]=A(()=>{},["prevent"])),model:r.value,class:"search-form",labelAlign:"left"},{default:o(()=>[t(j,{gutter:5},{default:o(()=>[t(_,{span:2},{default:o(()=>[t(m,null,{default:o(()=>[t(l,{type:"primary",onClick:e[0]||(e[0]=i=>x("add"))},{default:o(()=>[k("添加路线")]),_:1})]),_:1})]),_:1}),t(_,{span:5},{default:o(()=>[t(m,{label:""},{default:o(()=>[t(D,{modelValue:r.value.keyword,"onUpdate:modelValue":e[1]||(e[1]=i=>r.value.keyword=i),placeholder:"支持模糊搜索",onKeyup:z(c,["enter","native"]),allowClear:""},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),t(_,{span:2},{default:o(()=>[t(m,null,{default:o(()=>[t(l,{type:"danger",onClick:e[2]||(e[2]=i=>c())},{default:o(()=>[k("搜索")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),t(L,{columns:C,showPagination:!0,dataSource:g,fetch:c,options:S},{op:o(({index:i,row:h})=>[p("div",Q,[p("a",{href:"javascript:void(0)",class:"a-link",onClick:R=>$(h)},"查看",8,W),t(I,{direction:"vertical"}),p("a",{href:"javascript:void(0)",class:"a-link",onClick:R=>V(h)},"删除",8,X)])]),_:1},8,["dataSource"]),t(O,{title:a.title,show:a.show,buttons:a.buttons,onClose:e[4]||(e[4]=i=>a.show=!1),top:"0px",width:"1035px"},{default:o(()=>[t(N)]),_:1},8,["title","show","buttons"])],64)}}};export{oe as default};
